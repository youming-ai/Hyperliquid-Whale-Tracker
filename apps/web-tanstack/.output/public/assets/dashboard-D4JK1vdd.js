import{b as y,u as b,r as p,o as j,n as a,s as v,j as e,L as N}from"./index-VxbsqYbG.js";import{f as g}from"./utils-BN7U-suI.js";j({symbol:v(),price:a(),markPrice:a(),indexPrice:a(),fundingRate:a(),nextFundingTime:v(),openInterest:a(),volume24h:a(),change24h:a(),longShortRatio:a(),volatility24h:a()});j({timestamp:v(),open:a(),high:a(),low:a(),close:a(),volume:a()});async function w(t){return await new Promise(s=>setTimeout(s,200)),{symbol:t,price:42350+Math.random()*200-100,markPrice:42355,indexPrice:42348,fundingRate:.0012,nextFundingTime:new Date(Date.now()+14400*1e3).toISOString(),openInterest:85e7,volume24h:125e7,change24h:2.45+Math.random()*.5-.25,longShortRatio:1.15,volatility24h:3.2}}async function k(t,s,r=100){await new Promise(l=>setTimeout(l,200));const i=Date.now(),n={"1m":60*1e3,"5m":300*1e3,"15m":900*1e3,"1h":3600*1e3,"4h":14400*1e3,"1d":1440*60*1e3}[s]||3600*1e3;let o=42e3;return Array.from({length:r},(l,d)=>{const x=Math.random()*200-100;o+=x;const h=o,m=h+Math.random()*100,c=h-Math.random()*100,f=c+Math.random()*(m-c);return{timestamp:new Date(i-(r-d)*n).toISOString(),open:h,high:m,low:c,close:f,volume:Math.random()*1e6}})}function R(t){const{symbol:s,timeframe:r="1h",enableWebSocket:i=!0,refetchInterval:n=3e4}=t,o=y(),l=b({queryKey:["market","overview",s],queryFn:()=>w(s),refetchInterval:i?!1:n,staleTime:1e4}),d=b({queryKey:["market","ohlcv",s,r],queryFn:()=>k(s,r),staleTime:6e4}),x=p.useCallback(m=>{o.setQueryData(["market","overview",s],c=>c&&{...c,...m})},[o,s]);p.useEffect(()=>{if(!i)return;const m=setInterval(()=>{x({price:42350+Math.random()*200-100,change24h:2.45+Math.random()*.5-.25})},2e3);return()=>clearInterval(m)},[i,x]);const h=p.useCallback(()=>{l.refetch(),d.refetch()},[l,d]);return{overview:l.data,ohlcv:d.data,isLoading:l.isLoading||d.isLoading,isError:l.isError||d.isError,error:l.error||d.error,refetch:h,lastUpdated:l.dataUpdatedAt?new Date(l.dataUpdatedAt):null}}const T=[{rank:1,address:"0x1234...5678",pnl7d:125e3,winRate:68.5,trades:42},{rank:2,address:"0x2345...6789",pnl7d:98e3,winRate:72.3,trades:38},{rank:3,address:"0x3456...789a",pnl7d:85e3,winRate:65.2,trades:55},{rank:4,address:"0x4567...89ab",pnl7d:72e3,winRate:61.8,trades:29},{rank:5,address:"0x5678...9abc",pnl7d:65e3,winRate:59.4,trades:67}];function F(){const{overview:t,isLoading:s,lastUpdated:r}=R({symbol:"BTC-PERP",enableWebSocket:!0}),{data:i}=b({queryKey:["traders","top"],queryFn:async()=>(await new Promise(n=>setTimeout(n,300)),T)});return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Dashboard"}),r&&e.jsxs("span",{className:"text-sm opacity-60",children:["Last updated: ",r.toLocaleTimeString()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(u,{label:"BTC Price",value:s?"...":`$${t?.price.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,change:t?.change24h,loading:s}),e.jsx(u,{label:"24h Volume",value:s?"...":g(t?.volume24h??0),loading:s}),e.jsx(u,{label:"Open Interest",value:s?"...":g(t?.openInterest??0),loading:s}),e.jsx(u,{label:"Funding Rate",value:s?"...":`${((t?.fundingRate??0)*100).toFixed(4)}%`,loading:s})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-xl p-6",children:[e.jsx("p",{className:"text-sm opacity-60 mb-1",children:"Long/Short Ratio"}),e.jsx("p",{className:"text-2xl font-bold",children:t?.longShortRatio?.toFixed(2)??"..."}),e.jsx("div",{className:"mt-2 h-2 bg-[hsl(var(--muted))] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-success transition-all duration-300",style:{width:`${t?t.longShortRatio/(t.longShortRatio+1)*100:50}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs mt-1 opacity-60",children:[e.jsx("span",{children:"Longs"}),e.jsx("span",{children:"Shorts"})]})]}),e.jsxs("div",{className:"bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-xl p-6",children:[e.jsx("p",{className:"text-sm opacity-60 mb-1",children:"24h Volatility"}),e.jsxs("p",{className:"text-2xl font-bold",children:[t?.volatility24h?.toFixed(2)??"...","%"]}),e.jsx("div",{className:"mt-2 flex gap-1",children:Array.from({length:10}).map((n,o)=>e.jsx("div",{className:`h-4 flex-1 rounded ${o<(t?.volatility24h??0)/10*10?"bg-warning":"bg-[hsl(var(--muted))]"}`},o))})]}),e.jsxs("div",{className:"bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-xl p-6",children:[e.jsx("p",{className:"text-sm opacity-60 mb-1",children:"Next Funding"}),e.jsx("p",{className:"text-2xl font-bold",children:t?.nextFundingTime?new Date(t.nextFundingTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"..."}),e.jsxs("p",{className:"text-sm mt-1 text-success",children:["Rate: ",((t?.fundingRate??0)*100).toFixed(4),"%"]})]})]}),e.jsxs("div",{className:"bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Top Traders (7d PnL)"}),e.jsx(N,{to:"/traders",className:"text-sm text-[hsl(var(--primary))] hover:underline",children:"View All â†’"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm opacity-60 border-b border-[hsl(var(--border))]",children:[e.jsx("th",{className:"pb-3 pr-4",children:"#"}),e.jsx("th",{className:"pb-3 pr-4",children:"Address"}),e.jsx("th",{className:"pb-3 pr-4 text-right",children:"7d PnL"}),e.jsx("th",{className:"pb-3 pr-4 text-right",children:"Win Rate"}),e.jsx("th",{className:"pb-3 text-right",children:"Trades"})]})}),e.jsx("tbody",{children:i?.map(n=>e.jsxs("tr",{className:"border-b border-[hsl(var(--border))] last:border-0 hover:bg-[hsl(var(--accent))] transition-colors",children:[e.jsx("td",{className:"py-4 pr-4 font-medium",children:n.rank}),e.jsx("td",{className:"py-4 pr-4 font-mono text-sm",children:n.address}),e.jsxs("td",{className:"py-4 pr-4 text-right text-success font-medium",children:["+$",n.pnl7d.toLocaleString()]}),e.jsxs("td",{className:"py-4 pr-4 text-right",children:[n.winRate,"%"]}),e.jsx("td",{className:"py-4 text-right opacity-80",children:n.trades})]},n.rank))})]})})]})]})}function u({label:t,value:s,change:r,loading:i=!1}){return e.jsxs("div",{className:"bg-[hsl(var(--card))] border border-[hsl(var(--border))] rounded-xl p-6",children:[e.jsx("p",{className:"text-sm opacity-60 mb-1",children:t}),e.jsx("p",{className:`text-2xl font-bold ${i?"animate-pulse":""}`,children:s}),r!==void 0&&e.jsxs("p",{className:`text-sm mt-1 ${r>=0?"text-success":"text-destructive"}`,children:[r>=0?"+":"",r.toFixed(2),"%"]})]})}export{F as component};
